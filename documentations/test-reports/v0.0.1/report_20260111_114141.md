# Test Report: v0.0.1

- **Date**: 2026-01-11 11:41:41
- **Environment**: linux
- **Tester**: Automated Test Runner

---

## Summary

| Total | Pass | Fail | Skip |
| :---: | :--: | :--: | :--: |
| 54 | 49 | 4 | 1 |

## Test Details

### ⚠️ tests/config/test_template_vars.py::test_template_variable_consistency[usb]
- **Result**: SKIP
- **Error**:
```
('/home/ben/projects/ai4infra/tests/config/test_template_vars.py', 88, 'Skipped: No docker-compose.yml in usb')
```

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[redis]
- **Result**: PASS

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[dcmtk]
- **Result**: PASS

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[postgres]
- **Result**: PASS

### ❌ tests/config/test_template_vars.py::test_template_variable_consistency[vaultwarden]
- **Result**: FAIL
- **Error**:
```
service = 'vaultwarden'

    @pytest.mark.parametrize("service", get_services())
    def test_template_variable_consistency(service):
        """
        [Integrity Check] 템플릿에서 사용하는 변수가 Config에 정의되어 있는지 검사
        """
        compose_file = PROJECT_ROOT / "templates" / service / "docker-compose.yml"
    
        if not compose_file.exists():
            pytest.skip(f"No docker-compose.yml in {service}")
    
        try:
            required_vars = extract_variables_from_compose(compose_file)
        except Exception as e:
            pytest.fail(f"Failed to parse {compose_file}: {e}")
    
        if not required_vars:
            return
    
        defined_vars = load_config_compose_vars(service)
    
        # 3. Whitelist Update
        # - Global .env vars
        # - Auto-injected vars by env_manager.py
        global_whitelist = {
            "PROJECT_ROOT", "BASE_DIR", "PROJECT_NAME", "DOMAIN_NAME",
            # Auto-injected by env_manager
            "DATA_DIR", "CONF_DIR", "CERTS_DIR",
            # Credentials (usually in .env)
            "ORTHANC_ADMIN_PASSWORD", "ORTHANC_DB_PASSWORD",
            "POSTGRES_USER", "POSTGRES_PASSWORD", "POSTGRES_DB",
            "KEYCLOAK_ADMIN", "KEYCLOAK_ADMIN_PASSWORD",
            "VAULT_ADDR", "VAULT_TOKEN", "OPENREM_SECRET_KEY"
        }
    
        missing_vars = []
        for var in required_vars:
            if var in defined_vars:
                continue
            if var in global_whitelist:
                continue
    
            env_path = PROJECT_ROOT / ".env"
            if env_path.exists():
                if f"{var}=" in env_path.read_text():
                    continue
    
            missing_vars.append(var)
    
        if missing_vars:
>           pytest.fail(
                f"[{service}] Undefined variables in config/{service}.yml: {missing_vars}\n"
                f"Please define them in 'compose_vars' or ensure they are in .env"
            )
E           Failed: [vaultwarden] Undefined variables in config/vaultwarden.yml: ['DOMAIN']
E           Please define them in 'compose_vars' or ensure they are in .env

tests/config/test_template_vars.py:129: Failed
```

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[orthanc-mock]
- **Result**: PASS

### ❌ tests/config/test_template_vars.py::test_template_variable_consistency[openrem]
- **Result**: FAIL
- **Error**:
```
service = 'openrem'

    @pytest.mark.parametrize("service", get_services())
    def test_template_variable_consistency(service):
        """
        [Integrity Check] 템플릿에서 사용하는 변수가 Config에 정의되어 있는지 검사
        """
        compose_file = PROJECT_ROOT / "templates" / service / "docker-compose.yml"
    
        if not compose_file.exists():
            pytest.skip(f"No docker-compose.yml in {service}")
    
        try:
            required_vars = extract_variables_from_compose(compose_file)
        except Exception as e:
            pytest.fail(f"Failed to parse {compose_file}: {e}")
    
        if not required_vars:
            return
    
        defined_vars = load_config_compose_vars(service)
    
        # 3. Whitelist Update
        # - Global .env vars
        # - Auto-injected vars by env_manager.py
        global_whitelist = {
            "PROJECT_ROOT", "BASE_DIR", "PROJECT_NAME", "DOMAIN_NAME",
            # Auto-injected by env_manager
            "DATA_DIR", "CONF_DIR", "CERTS_DIR",
            # Credentials (usually in .env)
            "ORTHANC_ADMIN_PASSWORD", "ORTHANC_DB_PASSWORD",
            "POSTGRES_USER", "POSTGRES_PASSWORD", "POSTGRES_DB",
            "KEYCLOAK_ADMIN", "KEYCLOAK_ADMIN_PASSWORD",
            "VAULT_ADDR", "VAULT_TOKEN", "OPENREM_SECRET_KEY"
        }
    
        missing_vars = []
        for var in required_vars:
            if var in defined_vars:
                continue
            if var in global_whitelist:
                continue
    
            env_path = PROJECT_ROOT / ".env"
            if env_path.exists():
                if f"{var}=" in env_path.read_text():
                    continue
    
            missing_vars.append(var)
    
        if missing_vars:
>           pytest.fail(
                f"[{service}] Undefined variables in config/{service}.yml: {missing_vars}\n"
                f"Please define them in 'compose_vars' or ensure they are in .env"
            )
E           Failed: [openrem] Undefined variables in config/openrem.yml: ['OPENREM_DB_USER', 'OPENREM_DB_PORT', 'REDIS_HOST', 'OPENREM_DB_NAME', 'OPENREM_DB_HOST', 'ALLOWED_HOSTS']
E           Please define them in 'compose_vars' or ensure they are in .env

tests/config/test_template_vars.py:129: Failed
```

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[slicer]
- **Result**: PASS

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[orthanc-pseudo]
- **Result**: PASS

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[ldap]
- **Result**: PASS

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[nginx]
- **Result**: PASS

### ❌ tests/config/test_template_vars.py::test_template_variable_consistency[elk]
- **Result**: FAIL
- **Error**:
```
service = 'elk'

    @pytest.mark.parametrize("service", get_services())
    def test_template_variable_consistency(service):
        """
        [Integrity Check] 템플릿에서 사용하는 변수가 Config에 정의되어 있는지 검사
        """
        compose_file = PROJECT_ROOT / "templates" / service / "docker-compose.yml"
    
        if not compose_file.exists():
            pytest.skip(f"No docker-compose.yml in {service}")
    
        try:
            required_vars = extract_variables_from_compose(compose_file)
        except Exception as e:
            pytest.fail(f"Failed to parse {compose_file}: {e}")
    
        if not required_vars:
            return
    
        defined_vars = load_config_compose_vars(service)
    
        # 3. Whitelist Update
        # - Global .env vars
        # - Auto-injected vars by env_manager.py
        global_whitelist = {
            "PROJECT_ROOT", "BASE_DIR", "PROJECT_NAME", "DOMAIN_NAME",
            # Auto-injected by env_manager
            "DATA_DIR", "CONF_DIR", "CERTS_DIR",
            # Credentials (usually in .env)
            "ORTHANC_ADMIN_PASSWORD", "ORTHANC_DB_PASSWORD",
            "POSTGRES_USER", "POSTGRES_PASSWORD", "POSTGRES_DB",
            "KEYCLOAK_ADMIN", "KEYCLOAK_ADMIN_PASSWORD",
            "VAULT_ADDR", "VAULT_TOKEN", "OPENREM_SECRET_KEY"
        }
    
        missing_vars = []
        for var in required_vars:
            if var in defined_vars:
                continue
            if var in global_whitelist:
                continue
    
            env_path = PROJECT_ROOT / ".env"
            if env_path.exists():
                if f"{var}=" in env_path.read_text():
                    continue
    
            missing_vars.append(var)
    
        if missing_vars:
>           pytest.fail(
                f"[{service}] Undefined variables in config/{service}.yml: {missing_vars}\n"
                f"Please define them in 'compose_vars' or ensure they are in .env"
            )
E           Failed: [elk] Undefined variables in config/elk.yml: ['KIBANA_PASSWORD']
E           Please define them in 'compose_vars' or ensure they are in .env

tests/config/test_template_vars.py:129: Failed
```

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[keycloak]
- **Result**: PASS

### ✅ tests/config/test_template_vars.py::test_template_variable_consistency[orthanc-raw]
- **Result**: PASS

### ❌ tests/config/test_template_vars.py::test_template_variable_consistency[vault]
- **Result**: FAIL
- **Error**:
```
service = 'vault'

    @pytest.mark.parametrize("service", get_services())
    def test_template_variable_consistency(service):
        """
        [Integrity Check] 템플릿에서 사용하는 변수가 Config에 정의되어 있는지 검사
        """
        compose_file = PROJECT_ROOT / "templates" / service / "docker-compose.yml"
    
        if not compose_file.exists():
            pytest.skip(f"No docker-compose.yml in {service}")
    
        try:
            required_vars = extract_variables_from_compose(compose_file)
        except Exception as e:
            pytest.fail(f"Failed to parse {compose_file}: {e}")
    
        if not required_vars:
            return
    
        defined_vars = load_config_compose_vars(service)
    
        # 3. Whitelist Update
        # - Global .env vars
        # - Auto-injected vars by env_manager.py
        global_whitelist = {
            "PROJECT_ROOT", "BASE_DIR", "PROJECT_NAME", "DOMAIN_NAME",
            # Auto-injected by env_manager
            "DATA_DIR", "CONF_DIR", "CERTS_DIR",
            # Credentials (usually in .env)
            "ORTHANC_ADMIN_PASSWORD", "ORTHANC_DB_PASSWORD",
            "POSTGRES_USER", "POSTGRES_PASSWORD", "POSTGRES_DB",
            "KEYCLOAK_ADMIN", "KEYCLOAK_ADMIN_PASSWORD",
            "VAULT_ADDR", "VAULT_TOKEN", "OPENREM_SECRET_KEY"
        }
    
        missing_vars = []
        for var in required_vars:
            if var in defined_vars:
                continue
            if var in global_whitelist:
                continue
    
            env_path = PROJECT_ROOT / ".env"
            if env_path.exists():
                if f"{var}=" in env_path.read_text():
                    continue
    
            missing_vars.append(var)
    
        if missing_vars:
>           pytest.fail(
                f"[{service}] Undefined variables in config/{service}.yml: {missing_vars}\n"
                f"Please define them in 'compose_vars' or ensure they are in .env"
            )
E           Failed: [vault] Undefined variables in config/vault.yml: ['VAULT_API_ADDR']
E           Please define them in 'compose_vars' or ensure they are in .env

tests/config/test_template_vars.py:129: Failed
```

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file0]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file1]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file2]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file3]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file4]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file5]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file6]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file7]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file8]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file9]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file10]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file11]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file12]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file13]
- **Result**: PASS

### ✅ tests/config/test_yaml_schema.py::test_yaml_structure[config_file14]
- **Result**: PASS

### ✅ tests/test_logger_yaml.py::test_logger_yaml
- **Result**: PASS

### ✅ tests/unit/test_env_manager.py::TestEnvManager::test_extract_env_vars
- **Result**: PASS

### ✅ tests/unit/test_env_manager.py::TestEnvManager::test_merging_priority
- **Result**: PASS

### ✅ tests/unit/test_env_manager.py::TestEnvManager::test_standard_paths_injection
- **Result**: PASS

### ✅ tests/unit/test_excel_io.py::test_read_excels
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_simple_string
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_multiple_vars
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_repeated_var
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_no_vars
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_undefined_var
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_dict
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_nested_dict
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_list
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_nested_list
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_complex_structure
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_integer
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_float
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_boolean
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_none
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_empty_string
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_empty_dict
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_empty_list
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_with_special_chars
- **Result**: PASS

### ✅ tests/unit/test_substitute.py::TestSubstituteEnv::test_substitute_preserves_original
- **Result**: PASS

