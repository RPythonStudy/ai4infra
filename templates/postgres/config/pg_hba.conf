# PostgreSQL Client Authentication Configuration File
# [SEC-07] mTLS Enforcement Strategy
#
# RULE 1: mTLS Required (hostssl + cert + clientcert=verify-full)
# 모든 외부 접속(hostssl)은 반드시 클라이언트 인증서가 있어야 하며(cert),
# 그 인증서는 Root CA에 의해 서명된 유효한 것이어야 함(clientcert=verify-full).
# cn(Common Name)과 DB User Name이 일치해야 접속 허용됨.
hostssl all             all             0.0.0.0/0               cert clientcert=verify-full map=mtls_map
hostssl all             all             ::/0                    cert clientcert=verify-full map=mtls_map

# RULE 2: Localhost Exception (Optional, for debugging inside container)
# 컨테이너 내부 셸 접속을 위한 로컬 접속 허용 (비밀번호 없는 trust 또는 md5)
local   all             all                                     trust

# [User Mapping]
# 인증서의 CN과 DB 유저명이 다를 경우를 대비해 매핑 파일 참조 (pg_ident.conf)
# 기본적으로는 일치해야 함.
